# ProUpload æ–‡ä»¶ä¸Šä¼ ç»„ä»¶

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼ŒåŸºäº TDesign Upload ç»„ä»¶æ·±åº¦å°è£…ï¼Œæä¾›äº†é˜¿é‡Œäº‘ OSS ç›´ä¼ ã€å›¾ç‰‡è£å‰ªã€æ–‡ä»¶ç±»å‹è‡ªåŠ¨éªŒè¯ã€è¿›åº¦ç›‘æ§ç­‰ä¼ä¸šçº§ç‰¹æ€§ã€‚ç»„ä»¶æ”¯æŒå…¨å±€é…ç½®å’Œå±€éƒ¨é…ç½®çš„çµæ´»ç»„åˆï¼Œå†…ç½®äº†å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·å‹å¥½çš„æç¤ºæœºåˆ¶ï¼Œé€‚ç”¨äºå„ç§æ–‡ä»¶ä¸Šä¼ åœºæ™¯ã€‚

## ä½¿ç”¨åœºæ™¯

- **å•æ–‡ä»¶ä¸Šä¼ **ï¼šå¤´åƒä¸Šä¼ ã€èº«ä»½è¯ç…§ç‰‡ä¸Šä¼ ã€åˆåŒæ–‡ä»¶ä¸Šä¼ ç­‰
- **å›¾ç‰‡è£å‰ªä¸Šä¼ **ï¼šå¤´åƒè£å‰ªã€æ¨ªå¹…å›¾ç‰‡è£å‰ªã€äº§å“å›¾ç‰‡ç»Ÿä¸€å°ºå¯¸ç­‰
- **æ‰¹é‡æ–‡ä»¶ä¸Šä¼ **ï¼šäº§å“å›¾ç‰‡æ‰¹é‡ä¸Šä¼ ã€æ•°æ®å¯¼å…¥æ–‡ä»¶ä¸Šä¼ ç­‰
- **æ‹–æ‹½ä¸Šä¼ **ï¼šå¤§æ–‡ä»¶ä¸Šä¼ ã€å¤šæ–‡ä»¶åŒæ—¶ä¸Šä¼ ç­‰é«˜æ•ˆåœºæ™¯
- **å›¾ç‰‡å¢™**ï¼šå•†å“å›¾ç‰‡ç®¡ç†ã€ç…§ç‰‡ç›¸å†Œç­‰éœ€è¦ç¼©ç•¥å›¾å±•ç¤ºçš„åœºæ™¯
- **å®šåˆ¶ä¸Šä¼ **ï¼šç‰¹æ®Šæ ¼å¼æ–‡ä»¶å¤„ç†ã€ä¸Šä¼ å‰åŠ å¯†ã€å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ç­‰
- **ä¼ä¸šçº§åº”ç”¨**ï¼šOA ç³»ç»Ÿæ–‡ä»¶é™„ä»¶ã€CRM å®¢æˆ·èµ„æ–™ä¸Šä¼ ç­‰

## æ ¸å¿ƒç‰¹æ€§

- **OSS ç›´ä¼ **ï¼šå†…ç½®é˜¿é‡Œäº‘ OSS ç›´ä¼ æ”¯æŒï¼Œå‡å°‘æœåŠ¡å™¨å‹åŠ›
- **å›¾ç‰‡è£å‰ª**ï¼šå†…ç½®å›¾ç‰‡è£å‰ªåŠŸèƒ½ï¼Œæ”¯æŒè‡ªå®šä¹‰è£å‰ªæ¯”ä¾‹å’Œè£å‰ªå‚æ•°
- **ç±»å‹éªŒè¯**ï¼šè‡ªåŠ¨æ ¹æ® MIME ç±»å‹éªŒè¯æ–‡ä»¶æ ¼å¼ï¼Œæä¾›å‹å¥½æç¤º
- **è¿›åº¦ç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºä¸Šä¼ è¿›åº¦ï¼Œæ”¯æŒæš‚åœå’Œå–æ¶ˆæ“ä½œ
- **å…¨å±€é…ç½®**ï¼šæ”¯æŒé€šè¿‡ ProConfigProvider è¿›è¡Œå…¨å±€é…ç½®
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶å’Œç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- **è‡ªå®šä¹‰æ‰©å±•**ï¼šæ”¯æŒè‡ªå®šä¹‰ä¸Šä¼ é€»è¾‘ï¼Œçµæ´»é€‚é…å„ç§ä¸šåŠ¡éœ€æ±‚

## å¿«é€Ÿå¼€å§‹

åœ¨ä½¿ç”¨ ProUpload ç»„ä»¶ä¹‹å‰ï¼Œæ‚¨éœ€è¦ï¼š

1. **å‡†å¤‡ OSS é…ç½®**ï¼šè·å–é˜¿é‡Œäº‘ OSS çš„ AccessKeyã€Bucket ç­‰ä¿¡æ¯
2. **å®ç°ç­¾åæœåŠ¡**ï¼šåœ¨åç«¯å®ç°ä¸€ä¸ªè·å– OSS ä¸Šä¼ ç­¾åçš„æ¥å£
3. **é…ç½®ç­¾åå‡½æ•°**ï¼šåœ¨å‰ç«¯å®ç° `signature` å‡½æ•°ï¼Œè°ƒç”¨åç«¯æ¥å£è·å–ç­¾å

âš ï¸ **æç¤º**ï¼š

- å¦‚æœæ‚¨ä¸ä½¿ç”¨ OSS ç›´ä¼ ï¼Œå¯ä»¥é€šè¿‡ `request-method` å±æ€§è‡ªå®šä¹‰ä¸Šä¼ é€»è¾‘
- å›¾ç‰‡è£å‰ªåŠŸèƒ½åŸºäº `vue-cropper` åº“å®ç°ï¼Œç»„ä»¶å·²å†…ç½®è¯¥ä¾èµ–ï¼Œæ— éœ€é¢å¤–å®‰è£…

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, type UploadFile, Button as TButton, Icon as TIcon } from 'tdesign-vue-next'
import { CloudUploadIcon, UploadIcon } from 'tdesign-icons-vue-next'
import { ProUploadProps, ProConfigProvider } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])
const fileList2 = ref<UploadFile[]>([])
const fileList3 = ref<UploadFile[]>([
  {
    url: 'https://tdesign.gtimg.com/site/source/figma-pc.png',
    name: 'ç¤ºä¾‹å›¾ç‰‡.png',
    status: 'success'
  }
])

// æ¨¡æ‹Ÿè·å–åç«¯çš„ä¸Šä¼ ç­¾å
const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è°ƒç”¨æ‚¨çš„åç«¯æœåŠ¡æ¥è·å–ç­¾å
  // ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ“ä½œ
  await new Promise(resolve => setTimeout(resolve, 300))

  // æ¨¡æ‹Ÿç­¾åæ•°æ®
  return {
    accessId: 'YOUR_ACCESS_ID',
    dir: 'user-uploads',
    host: 'https://your-oss-bucket.oss-cn-hangzhou.aliyuncs.com',
    policy: 'YOUR_POLICY_BASE64',
    signature: 'YOUR_SIGNATURE',
    fileName: `demo_${Date.now()}_${file.name}`
  }
}

const handleSuccess: ProUploadProps['onSuccess'] = ({ file, fileList }) => {
  MessagePlugin.success(`æ–‡ä»¶ ${file.name} ä¸Šä¼ æˆåŠŸ`)
  console.log('ä¸Šä¼ æˆåŠŸ:', file, fileList)
}

const handleFail: ProUploadProps['onFail'] = ({ file, error }) => {
  MessagePlugin.error(`æ–‡ä»¶ ${file.name} ä¸Šä¼ å¤±è´¥`)
  console.log('ä¸Šä¼ å¤±è´¥:', file, error)
}

const beforeUploadCheck: ProUploadProps['beforeUpload'] = (file) => {
  if (file.size! > 5 * 1024 * 1024) {
    MessagePlugin.warning('ä¸Šä¼ çš„æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 5MB')
    return false
  }
  return true
}

// è‡ªå®šä¹‰ä¸Šä¼ é€»è¾‘
const customUploadFn: ProUploadProps['requestMethod'] = () => {
  const [file] = files
  return new Promise(resolve => {
    const formData = new FormData()
    formData.append('file', file as any)
    formData.append('filename', file.name)

    // æ¨¡æ‹Ÿä¸Šä¼ è¿›åº¦
    let percent = 0
    const interval = setInterval(() => {
      percent += 10
      if (percent >= 100) {
        clearInterval(interval)
        // æ¨¡æ‹ŸæˆåŠŸå“åº”
        const response = {
          status: 'success' as const,
          response: {
            url: URL.createObjectURL(file.raw!),
            name: file.name
          }
        }
        MessagePlugin.success('è‡ªå®šä¹‰ä¸Šä¼ æˆåŠŸ')
        resolve(response)
      }
    }, 200)
  })
}
</script>

## åŸºç¡€ç”¨æ³•

æœ€åŸºç¡€çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æŒ‡å®šåŒºåŸŸå³å¯ä¸Šä¼ ã€‚

<DemoBox title="åŸºç¡€ç”¨æ³•" description="ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ ">
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    @success="handleSuccess"
    @fail="handleFail"
  />
</DemoBox>

```vue
<template>
  <ProUpload v-model="fileList" :signature="getSignature" @success="handleSuccess" @fail="handleFail" />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, UploadFile, ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

// æ¨¡æ‹Ÿè·å–åç«¯çš„ä¸Šä¼ ç­¾å
const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è°ƒç”¨æ‚¨çš„åç«¯æœåŠ¡æ¥è·å–ç­¾å
  return {
    accessId: 'YOUR_ACCESS_ID',
    dir: 'user-uploads',
    host: 'https://your-oss-bucket.oss-cn-hangzhou.aliyuncs.com',
    policy: 'YOUR_POLICY_BASE64',
    signature: 'YOUR_SIGNATURE',
    fileName: `demo_${Date.now()}_${file.name}`
  }
}

const handleSuccess: ProUploadProps['onSuccess'] = ({ file, fileList }) => {
  MessagePlugin.success(`æ–‡ä»¶ ${file.name} ä¸Šä¼ æˆåŠŸ`)
}

const handleFail: ProUploadProps['onFail'] = ({ file, error }) => {
  MessagePlugin.error(`æ–‡ä»¶ ${file.name} ä¸Šä¼ å¤±è´¥`)
}
</script>
```

## æ‹–æ‹½ä¸Šä¼ 

é€šè¿‡ `draggable` å±æ€§å¼€å¯æ‹–æ‹½ä¸Šä¼ ã€‚

<DemoBox title="æ‹–æ‹½ä¸Šä¼ " description="å°†æ–‡ä»¶æ‹–æ‹½åˆ°æŒ‡å®šåŒºåŸŸè¿›è¡Œä¸Šä¼ ">
  <ProUpload
    v-model="fileList2"
    draggable
    :signature="getSignature"
    accept="image/*"
    :before-upload="beforeUploadCheck"
    @success="handleSuccess"
    @fail="handleFail"
  >
    <div class="p-8 border border-dashed rounded-md text-center cursor-pointer hover:border-primary">
      <TIcon name="cloud-upload" size="48px" class="text-gray-400" />
      <p class="mt-2 text-sm text-gray-600">å°†å›¾ç‰‡æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<span class="text-primary">ç‚¹å‡»ä¸Šä¼ </span></p>
      <p class="text-xs text-gray-400 mt-1">ä»…æ”¯æŒå›¾ç‰‡æ–‡ä»¶ï¼Œå¤§å°ä¸è¶…è¿‡ 5MB</p>
    </div>
  </ProUpload>
</DemoBox>

```vue
<template>
  <ProUpload
    v-model="fileList"
    draggable
    :signature="getSignature"
    accept="image/*"
    :before-upload="beforeUploadCheck"
    @success="handleSuccess"
    @fail="handleFail"
  >
    <div class="custom-drag-area">
      <TIcon name="cloud-upload" size="48px" />
      <p>å°†å›¾ç‰‡æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<span class="text-primary">ç‚¹å‡»ä¸Šä¼ </span></p>
      <p class="tip">ä»…æ”¯æŒå›¾ç‰‡æ–‡ä»¶ï¼Œå¤§å°ä¸è¶…è¿‡ 5MB</p>
    </div>
  </ProUpload>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, UploadFile, ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // ... è·å–ç­¾åé€»è¾‘
}

const handleSuccess: ProUploadProps['onSuccess'] = ({ file }) => {
  MessagePlugin.success(`${file.name} ä¸Šä¼ æˆåŠŸ`)
}

const handleFail: ProUploadProps['onFail'] = ({ file }) => {
  MessagePlugin.error(`${file.name} ä¸Šä¼ å¤±è´¥`)
}

const beforeUploadCheck: ProUploadProps['beforeUpload'] = file => {
  if (file.size! > 5 * 1024 * 1024) {
    MessagePlugin.warning('ä¸Šä¼ çš„æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 5MB')
    return false
  }
  return true
}
</script>
```

## å›¾ç‰‡å¢™

è®¾ç½® `theme="image"` å¯ä»¥å±•ç¤ºä¸ºå›¾ç‰‡å¢™ï¼Œå¹¶æ”¯æŒé¢„è§ˆã€‚

<DemoBox title="å›¾ç‰‡å¢™" description="ç”¨äºä¸Šä¼ å›¾ç‰‡å¹¶å±•ç¤ºç¼©ç•¥å›¾">
  <ProUpload
    v-model="fileList3"
    theme="image"
    :signature="getSignature"
    accept="image/*"
    :max="5"
    multiple
    @success="handleSuccess"
    @fail="handleFail"
  />
</DemoBox>

```vue
<template>
  <ProUpload
    v-model="fileList"
    theme="image"
    :signature="getSignature"
    accept="image/*"
    :max="5"
    multiple
    @success="handleSuccess"
    @fail="handleFail"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import type { UploadFile, ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([
  {
    url: 'https://tdesign.gtimg.com/site/source/figma-pc.png',
    name: 'ç¤ºä¾‹å›¾ç‰‡.png',
    status: 'success'
  }
])

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // ... è·å–ç­¾åé€»è¾‘
}

const handleSuccess: ProUploadProps['onSuccess'] = e => {
  // ...
}

const handleFail: ProUploadProps['onFail'] = e => {
  // ...
}
</script>
```

## å›¾ç‰‡è£å‰ª

é€šè¿‡ `aspect-ratio` å±æ€§å¼€å¯å›¾ç‰‡è£å‰ªåŠŸèƒ½ï¼Œæ”¯æŒè‡ªå®šä¹‰è£å‰ªæ¯”ä¾‹ã€‚ç»„ä»¶ä¼šåœ¨ä¸Šä¼ å›¾ç‰‡å‰è‡ªåŠ¨å¼¹å‡ºè£å‰ªå¼¹çª—ã€‚

<DemoBox title="å›¾ç‰‡è£å‰ª" description="ä¸Šä¼ å›¾ç‰‡å‰è¿›è¡Œè£å‰ªï¼Œæ”¯æŒè‡ªå®šä¹‰è£å‰ªæ¯”ä¾‹">
  <div class="space-y-4">
    <ProUpload
      v-model="fileList"
      :signature="getSignature"
      accept="image/*"
      aspect-ratio="16:9"
      theme="image"
      @success="handleSuccess"
      @fail="handleFail"
    />
    <p class="text-sm text-gray-500">è£å‰ªæ¯”ä¾‹ï¼š16:9ï¼ˆé€‚ç”¨äºæ¨ªå¹…å›¾ç‰‡ï¼‰</p>
  </div>
</DemoBox>

```vue
<template>
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept="image/*"
    aspect-ratio="16:9"
    theme="image"
    @success="handleSuccess"
    @fail="handleFail"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, type UploadFile, type ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // è·å–ç­¾åé€»è¾‘...
  return {
    accessId: 'YOUR_ACCESS_ID',
    dir: 'user-uploads',
    host: 'https://your-oss-bucket.oss-cn-hangzhou.aliyuncs.com',
    policy: 'YOUR_POLICY_BASE64',
    signature: 'YOUR_SIGNATURE',
    fileName: `demo_${Date.now()}_${file.name}`
  }
}

const handleSuccess: ProUploadProps['onSuccess'] = ({ file }) => {
  MessagePlugin.success(`${file.name} ä¸Šä¼ æˆåŠŸ`)
}

const handleFail: ProUploadProps['onFail'] = ({ file }) => {
  MessagePlugin.error(`${file.name} ä¸Šä¼ å¤±è´¥`)
}
</script>
```

### è‡ªå®šä¹‰è£å‰ªå‚æ•°

é€šè¿‡ `cropper-props` å’Œ `dialog-props` å¯ä»¥è‡ªå®šä¹‰è£å‰ªå™¨å’Œå¼¹çª—çš„é…ç½®ã€‚

<DemoBox title="è‡ªå®šä¹‰è£å‰ªå‚æ•°" description="è‡ªå®šä¹‰è£å‰ªå™¨çš„è¾“å‡ºæ ¼å¼ã€è´¨é‡ç­‰å‚æ•°">
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept="image/*"
    aspect-ratio="1:1"
    :cropper-props="{
      outputType: 'jpeg',
      outputSize: 0.8,
      canScale: true,
      autoCropWidth: 200,
      autoCropHeight: 200
    }"
    :dialog-props="{
      header: 'è£å‰ªå¤´åƒ',
      width: '800px'
    }"
    theme="image"
    @success="handleSuccess"
  />
</DemoBox>

```vue
<template>
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept="image/*"
    aspect-ratio="1:1"
    :cropper-props="{
      outputType: 'jpeg',
      outputSize: 0.8,
      canScale: true,
      autoCropWidth: 200,
      autoCropHeight: 200
    }"
    :dialog-props="{
      header: 'è£å‰ªå¤´åƒ',
      width: '800px'
    }"
    theme="image"
    @success="handleSuccess"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import type { UploadFile, ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // è·å–ç­¾åé€»è¾‘...
}

const handleSuccess: ProUploadProps['onSuccess'] = ({ file }) => {
  console.log('è£å‰ªåçš„å›¾ç‰‡å·²ä¸Šä¼ :', file)
}
</script>
```

## è‡ªå®šä¹‰ä¸Šä¼ æ–¹æ³•

é€šè¿‡ `request-method` å±æ€§å¯ä»¥å®Œå…¨è‡ªå®šä¹‰ä¸Šä¼ çš„è¡Œä¸ºï¼Œé€‚ç”¨äºä¸ä½¿ç”¨å†…ç½® OSS ä¸Šä¼ çš„åœºæ™¯ã€‚

<DemoBox title="è‡ªå®šä¹‰ä¸Šä¼ æ–¹æ³•" description="ä½¿ç”¨ request-method è¦†ç›–é»˜è®¤çš„ä¸Šä¼ é€»è¾‘">
  <ProUpload
    v-model="fileList"
    :request-method="customUploadFn"
  >
    <TButton theme="primary">
      <template #icon>
        <TIcon name="upload" />
      </template>
      è‡ªå®šä¹‰ä¸Šä¼ 
    </TButton>
  </ProUpload>
</DemoBox>

```vue
<template>
  <ProUpload v-model="fileList" :request-method="customUploadFn">
    <TButton theme="primary">
      <template #icon>
        <TIcon name="upload" />
      </template>
      è‡ªå®šä¹‰ä¸Šä¼ 
    </TButton>
  </ProUpload>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, UploadFile, ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

// è‡ªå®šä¹‰ä¸Šä¼ é€»è¾‘
const customUploadFn: ProUploadProps['requestMethod'] = files => {
  const [file] = files
  return new Promise(resolve => {
    const formData = new FormData()
    formData.append('file', file as any)
    formData.append('filename', file.name)

    // æ¨¡æ‹Ÿä¸Šä¼ è¿›åº¦
    let percent = 0
    const interval = setInterval(() => {
      percent += 10
      if (percent >= 100) {
        clearInterval(interval)
        // æ¨¡æ‹ŸæˆåŠŸå“åº”
        const response = {
          status: 'success' as const,
          response: {
            url: URL.createObjectURL(file.raw!),
            name: file.name
          }
        }
        MessagePlugin.success('è‡ªå®šä¹‰ä¸Šä¼ æˆåŠŸ')
        resolve(response)
      }
    }, 200)
  })
}
</script>
```

## å…¨å±€é…ç½®ä¸ Props

`ProUpload` ç»„ä»¶çš„è®¸å¤šæ ¸å¿ƒåŠŸèƒ½ï¼Œå¦‚ `signature`ã€`rename`ã€`beforeUpload` `requestMethod` å’Œ `onFail` ç­‰ï¼Œéƒ½æ”¯æŒä¸¤ç§é…ç½®æ–¹å¼ï¼š

1.  **å…¨å±€é…ç½®**ï¼šé€šè¿‡ `ProConfigProvider` ç»„ä»¶åœ¨åº”ç”¨æ ¹éƒ¨è¿›è¡Œç»Ÿä¸€é…ç½®ã€‚è¿™å¯¹äºéœ€è¦å…¨ç«™ç»Ÿä¸€ä¸Šä¼ è¡Œä¸ºçš„åœºæ™¯éå¸¸æœ‰ç”¨ã€‚
2.  **Props å•ç‹¬é…ç½®**ï¼šç›´æ¥åœ¨ `ProUpload` ç»„ä»¶ä¸Šé€šè¿‡ `props` è¿›è¡Œé…ç½®ã€‚

å½“ä¸¤ç§é…ç½®åŒæ—¶å­˜åœ¨æ—¶ï¼Œ**`props` çš„ä¼˜å…ˆçº§æ€»æ˜¯é«˜äº `ProConfigProvider` ä¸­çš„å…¨å±€é…ç½®**ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å…ˆè¿›è¡Œå…¨å±€é…ç½®ï¼Œç„¶ååœ¨ä¸ªåˆ«éœ€è¦ç‰¹æ®Šå¤„ç†çš„ `ProUpload` å®ä¾‹ä¸Šé€šè¿‡ `props` è¿›è¡Œè¦†ç›–ã€‚

## é«˜çº§ç”¨æ³•

### æ–‡ä»¶ç±»å‹é™åˆ¶å’Œå¤§å°éªŒè¯

ç»„ä»¶å†…ç½®äº†æ™ºèƒ½çš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼Œæ”¯æŒ MIME ç±»å‹åŒ¹é…å’Œå‹å¥½çš„é”™è¯¯æç¤ºã€‚

<DemoBox title="æ–‡ä»¶ç±»å‹é™åˆ¶" description="åªå…è®¸ä¸Šä¼  PDF å’Œ Word æ–‡æ¡£">
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept=".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    :before-upload="beforeUploadCheck"
    @success="handleSuccess"
    @fail="handleFail"
  >
    <TButton theme="primary">
      <template #icon>
        <UploadIcon />
      </template>
      ä¸Šä¼ æ–‡æ¡£
    </TButton>
  </ProUpload>
</DemoBox>

```vue
<template>
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept=".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    :before-upload="beforeUploadCheck"
    @success="handleSuccess"
    @fail="handleFail"
  >
    <TButton theme="primary">
      <UploadIcon />
      ä¸Šä¼ æ–‡æ¡£
    </TButton>
  </ProUpload>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, type UploadFile, type ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])

const beforeUploadCheck: ProUploadProps['beforeUpload'] = file => {
  const maxSize = 10 * 1024 * 1024 // 10MB
  if (file.size! > maxSize) {
    MessagePlugin.warning('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 10MB')
    return false
  }
  return true
}

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // è·å–ç­¾åé€»è¾‘...
}
</script>
```

### å›¾ç‰‡å‹ç¼©å’Œé¢„å¤„ç†

ç»“åˆ `before-upload` å±æ€§å¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©å¤„ç†ã€‚

```vue
<template>
  <ProUpload
    v-model="fileList"
    :signature="getSignature"
    accept="image/*"
    :before-upload="compressImage"
    theme="image"
    multiple
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MessagePlugin, type ProUploadProps } from '@seevin/ui'

const fileList = ref([])

const compressImage: ProUploadProps['beforeUpload'] = file => {
  return new Promise(resolve => {
    const canvas = document.createElement('canvas')
    const ctx = canvas.getContext('2d')
    const img = new Image()

    img.onload = () => {
      // è®¡ç®—å‹ç¼©åçš„å°ºå¯¸
      const maxWidth = 1920
      const maxHeight = 1080
      let { width, height } = img

      if (width > maxWidth || height > maxHeight) {
        const ratio = Math.min(maxWidth / width, maxHeight / height)
        width *= ratio
        height *= ratio
      }

      canvas.width = width
      canvas.height = height

      // ç»˜åˆ¶å‹ç¼©åçš„å›¾ç‰‡
      ctx?.drawImage(img, 0, 0, width, height)

      canvas.toBlob(
        blob => {
          if (blob) {
            // æ›¿æ¢åŸæ–‡ä»¶
            const compressedFile = new File([blob], file.name, {
              type: file.type,
              lastModified: Date.now()
            })

            // æ›´æ–°æ–‡ä»¶å¯¹è±¡
            Object.assign(file, {
              raw: compressedFile,
              size: compressedFile.size
            })

            MessagePlugin.success(`å›¾ç‰‡å·²å‹ç¼©ï¼š${(file.size! / 1024 / 1024).toFixed(2)}MB`)
          }
          resolve(true)
        },
        file.type,
        0.8
      )
    }

    img.src = URL.createObjectURL(file.raw!)
  })
}
</script>
```

### æ‰¹é‡ä¸Šä¼ è¿›åº¦ç›‘æ§

å¯¹äºå¤§é‡æ–‡ä»¶ä¸Šä¼ ï¼Œå¯ä»¥ç›‘æ§æ•´ä½“è¿›åº¦ã€‚

```vue
<template>
  <div>
    <ProUpload
      v-model="fileList"
      :signature="getSignature"
      multiple
      :max="10"
      @progress="handleProgress"
      @success="handleBatchSuccess"
    >
      <div class="upload-area">
        <p>æ‰¹é‡ä¸Šä¼ æ–‡ä»¶ï¼ˆæœ€å¤š10ä¸ªï¼‰</p>
        <p class="text-sm text-gray-500">æ”¯æŒæ‹–æ‹½å¤šä¸ªæ–‡ä»¶</p>
      </div>
    </ProUpload>

    <div v-if="totalProgress > 0" class="mt-4">
      <div class="flex justify-between text-sm text-gray-600">
        <span>æ•´ä½“è¿›åº¦</span>
        <span>{{ totalProgress.toFixed(1) }}%</span>
      </div>
      <div class="w-full bg-gray-200 rounded h-2 mt-1">
        <div class="bg-blue-500 h-2 rounded transition-all duration-300" :style="{ width: `${totalProgress}%` }"></div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { type UploadFile, type ProUploadProps } from '@seevin/ui'

const fileList = ref<UploadFile[]>([])
const progressMap = ref<Record<string, number>>({})

// è®¡ç®—æ•´ä½“è¿›åº¦
const totalProgress = computed(() => {
  const progresses = Object.values(progressMap.value)
  if (progresses.length === 0) return 0
  return progresses.reduce((sum, progress) => sum + progress, 0) / progresses.length
})

const handleProgress: ProUploadProps['onProgress'] = ({ file, percent }) => {
  progressMap.value[file.id || file.name] = percent
}

const handleBatchSuccess: ProUploadProps['onSuccess'] = ({ file }) => {
  // ä¸Šä¼ æˆåŠŸåç§»é™¤è¿›åº¦è®°å½•
  delete progressMap.value[file.id || file.name]

  // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Šä¼ å®Œæˆ
  if (Object.keys(progressMap.value).length === 0) {
    MessagePlugin.success('æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ å®Œæˆï¼')
  }
}
</script>
```

<DemoBox title="é…ç½®ä¼˜å…ˆçº§ç¤ºä¾‹" description="ç¬¬ä¸€ä¸ªä¸Šä¼ ç»„ä»¶ä½¿ç”¨å…¨å±€é…ç½®çš„ renameï¼Œç¬¬äºŒä¸ªé€šè¿‡ prop è¦†ç›–å®ƒã€‚">
  <ProConfigProvider :config="{ ProUpload: { rename: file => `global_${file.name}` } }">
    <div class="space-y-4">
      <p>â†“ è¿™ä¸ªç»„ä»¶ä¼šä½¿ç”¨å…¨å±€é…ç½®çš„ rename å‡½æ•°ï¼Œæ–‡ä»¶åå‰ç¼€ä¸º 'global_'</p>
      <ProUpload :signature="getSignature">
        <TButton>å…¨å±€é…ç½®ä¸Šä¼ </TButton>
      </ProUpload>
      <p>â†“ è¿™ä¸ªç»„ä»¶ä½¿ç”¨ prop è¦†ç›–äº†å…¨å±€é…ç½®ï¼Œæ–‡ä»¶åå‰ç¼€ä¸º 'local_'</p>
      <ProUpload :signature="getSignature" :rename="file => `local_${file.name}`">
        <TButton>Prop è¦†ç›–ä¸Šä¼ </TButton>
      </ProUpload>
    </div>
  </ProConfigProvider>
</DemoBox>

```vue
<template>
  <ProConfigProvider :config="globalUploadConfig">
    <div class="space-y-4">
      <p>â†“ è¿™ä¸ªç»„ä»¶ä¼šä½¿ç”¨å…¨å±€é…ç½®çš„ rename å‡½æ•°ï¼Œæ–‡ä»¶åå‰ç¼€ä¸º 'global_'</p>
      <ProUpload :signature="getSignature">
        <TButton>å…¨å±€é…ç½®ä¸Šä¼ </TButton>
      </ProUpload>

      <p>â†“ è¿™ä¸ªç»„ä»¶ä½¿ç”¨ prop è¦†ç›–äº†å…¨å±€é…ç½®ï¼Œæ–‡ä»¶åå‰ç¼€ä¸º 'local_'</p>
      <ProUpload :signature="getSignature" :rename="file => `local_${file.name}`">
        <TButton>Prop è¦†ç›–ä¸Šä¼ </TButton>
      </ProUpload>
    </div>
  </ProConfigProvider>
</template>

<script setup lang="ts">
import { reactive } from 'vue'
import { CConfig, ProUploadProps } from '@seevin/ui'

const globalUploadConfig = reactive<CConfig>({
  ProUpload: {
    rename: file => `global_${file.name}`
  }
})

const getSignature: ProUploadProps['signature'] = async (fileName, file) => {
  // ... æ¨¡æ‹Ÿç­¾åé€»è¾‘
  return {
    accessId: 'YOUR_ACCESS_ID',
    dir: 'user-uploads',
    host: 'https://your-oss-bucket.oss-cn-hangzhou.aliyuncs.com',
    policy: 'YOUR_POLICY_BASE64',
    signature: 'YOUR_SIGNATURE',
    fileName: `demo_${Date.now()}_${file.name}`
  }
}
</script>
```

## API

### Props

| åç§°           | ç±»å‹                                                                  | é»˜è®¤å€¼                             | è¯´æ˜                                                                                                   |
| -------------- | --------------------------------------------------------------------- | ---------------------------------- | ------------------------------------------------------------------------------------------------------ |
| `signature`    | `(fileName: string, file: UploadFile) => Promise<ProUploadSignature>` | `-`                                | **å¿…éœ€**ã€‚è·å– OSS ä¸Šä¼ ç­¾åä¿¡æ¯çš„å‡½æ•°ã€‚å‡½æ•°ä¼˜å…ˆçº§ï¼š`props` > `ProConfigProvider`ã€‚                     |
| `rename`       | `(file: UploadFile) => string`                                        | `() => generateUUID() + file.name` | æ–‡ä»¶é‡å‘½åå‡½æ•°ï¼Œè¿”å›æ–°çš„æ–‡ä»¶åã€‚                                                                       |
| `aspectRatio`  | `string`                                                              | `-`                                | å›¾ç‰‡è£å‰ªæ¯”ä¾‹ï¼Œæ ¼å¼ä¸º `"4:3"` æˆ– `"16:9"`ã€‚è®¾ç½®åä¼šåœ¨ä¸Šä¼ å›¾ç‰‡å‰è‡ªåŠ¨å¼¹å‡ºè£å‰ªå¼¹çª—ã€‚                       |
| `cropperProps` | `Record<string, any>`                                                 | è§ä¸‹æ–¹é»˜è®¤å€¼                       | `vue-cropper` çš„é…ç½®é¡¹ï¼Œç”¨äºè‡ªå®šä¹‰è£å‰ªå™¨è¡Œä¸ºã€‚[æŸ¥çœ‹å®Œæ•´é…ç½®](https://github.com/xyxiao001/vue-cropper) |
| `dialogProps`  | `DialogProps`                                                         | `-`                                | `TDesign Dialog` çš„é…ç½®é¡¹ï¼Œç”¨äºè‡ªå®šä¹‰è£å‰ªå¼¹çª—æ ·å¼å’Œè¡Œä¸ºã€‚                                              |

#### cropperProps é»˜è®¤é…ç½®

ç»„ä»¶ä¸º `vue-cropper` æä¾›äº†ä»¥ä¸‹é»˜è®¤é…ç½®ï¼Œæ‚¨å¯ä»¥é€šè¿‡ `cropperProps` è¦†ç›–è¿™äº›é»˜è®¤å€¼ï¼š

```javascript
{
  outputSize: 1,        // è¾“å‡ºå›¾ç‰‡è´¨é‡ï¼ˆ0-1ï¼‰
  outputType: 'png',    // è¾“å‡ºå›¾ç‰‡æ ¼å¼ï¼ˆjpeg/png/webpï¼‰
  info: true,           // æ˜¾ç¤ºè£å‰ªä¿¡æ¯
  full: false,          // æ˜¯å¦è¾“å‡ºåŸå›¾æ¯”ä¾‹çš„æˆªå›¾
  canMove: true,        // å›¾ç‰‡æ˜¯å¦å¯ä»¥ç§»åŠ¨
  canMoveBox: true,     // è£å‰ªæ¡†æ˜¯å¦å¯ä»¥ç§»åŠ¨
  original: false,      // æ˜¯å¦æŒ‰åŸå§‹æ¯”ä¾‹æ¸²æŸ“
  autoCrop: true,       // æ˜¯å¦é»˜è®¤ç”Ÿæˆæˆªå›¾æ¡†
  fixed: true,          // æ˜¯å¦å›ºå®šè£å‰ªæ¡†æ¯”ä¾‹
  centerBox: true,      // è£å‰ªæ¡†æ˜¯å¦é™åˆ¶åœ¨å›¾ç‰‡å†…
  infoTrue: true,       // æ˜¯å¦æ˜¾ç¤ºçœŸå®çš„è¾“å‡ºå›¾ç‰‡å®½é«˜
  mode: 'contain'       // å›¾ç‰‡æ¸²æŸ“æ¨¡å¼ï¼ˆcontain/coverï¼‰
}
```

åŒæ—¶ç»§æ‰¿ `TDesign Upload` çš„æ‰€æœ‰ `Props`ï¼Œå¸¸ç”¨å±æ€§åŒ…æ‹¬ï¼š

| åç§°            | ç±»å‹                                                      | é»˜è®¤å€¼   | è¯´æ˜                                                                       |
| --------------- | --------------------------------------------------------- | -------- | -------------------------------------------------------------------------- |
| `accept`        | `string`                                                  | `-`      | å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼Œä½¿ç”¨ MIME ç±»å‹ï¼Œå¦‚ `image/*` æˆ– `image/jpeg,image/png` |
| `multiple`      | `boolean`                                                 | `false`  | æ˜¯å¦æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼                                                          |
| `max`           | `number`                                                  | `-`      | æœ€å¤§ä¸Šä¼ æ–‡ä»¶æ•°é‡                                                           |
| `maxSize`       | `number`                                                  | `-`      | å•ä¸ªæ–‡ä»¶çš„æœ€å¤§å°ºå¯¸ï¼ˆå­—èŠ‚ï¼‰                                                 |
| `disabled`      | `boolean`                                                 | `false`  | æ˜¯å¦ç¦ç”¨ä¸Šä¼                                                                |
| `draggable`     | `boolean`                                                 | `false`  | æ˜¯å¦æ”¯æŒæ‹–æ‹½ä¸Šä¼                                                            |
| `theme`         | `'file' \| 'image' \| 'image-flow' \| 'custom'`           | `'file'` | ä¸Šä¼ ç»„ä»¶é£æ ¼                                                               |
| `beforeUpload`  | `(file: UploadFile) => boolean \| Promise<boolean>`       | `-`      | ä¸Šä¼ æ–‡ä»¶ä¹‹å‰çš„éªŒè¯å‡½æ•°                                                     |
| `requestMethod` | `(files: UploadFile[]) => Promise<RequestMethodResponse>` | `-`      | è‡ªå®šä¹‰ä¸Šä¼ æ–¹æ³•ï¼Œè¦†ç›–é»˜è®¤çš„ OSS ä¸Šä¼                                         |

ğŸ”— [æŸ¥çœ‹ TDesign Upload å®Œæ•´ Props](https://tdesign.tencent.com/vue-next/components/upload?tab=api)

### Events

ç»§æ‰¿ `TDesign Upload` çš„æ‰€æœ‰ `Events`ï¼Œå¸¸ç”¨äº‹ä»¶åŒ…æ‹¬ï¼š

| åç§°           | å‚æ•°                                                           | è¯´æ˜               |
| -------------- | -------------------------------------------------------------- | ------------------ |
| `success`      | `{ file: UploadFile, fileList: UploadFile[], response?: any }` | ä¸Šä¼ æˆåŠŸæ—¶è§¦å‘     |
| `fail`         | `{ file: UploadFile, e: Error, response?: any }`               | ä¸Šä¼ å¤±è´¥æ—¶è§¦å‘     |
| `progress`     | `{ file: UploadFile, percent: number }`                        | ä¸Šä¼ è¿›åº¦å˜åŒ–æ—¶è§¦å‘ |
| `remove`       | `{ file: UploadFile, fileList: UploadFile[] }`                 | ç§»é™¤æ–‡ä»¶æ—¶è§¦å‘     |
| `preview`      | `{ file: UploadFile }`                                         | ç‚¹å‡»æ–‡ä»¶é¢„è§ˆæ—¶è§¦å‘ |
| `selectChange` | `{ files: UploadFile[] }`                                      | é€‰æ‹©æ–‡ä»¶å˜åŒ–æ—¶è§¦å‘ |

ğŸ”— [æŸ¥çœ‹ TDesign Upload å®Œæ•´ Events](https://tdesign.tencent.com/vue-next/components/upload?tab=api)

### Slots

ç»§æ‰¿ `TDesign Upload` çš„æ‰€æœ‰ `Slots`ï¼š

| åç§°                 | å‚æ•°                      | è¯´æ˜                 |
| -------------------- | ------------------------- | -------------------- |
| `default`            | `-`                       | é»˜è®¤ä¸Šä¼ æŒ‰é’®åŒºåŸŸ     |
| `trigger`            | `-`                       | è‡ªå®šä¹‰è§¦å‘ä¸Šä¼ çš„å…ƒç´  |
| `tips`               | `-`                       | ä¸Šä¼ æç¤ºæ–‡æ¡ˆ         |
| `dragContent`        | `-`                       | æ‹–æ‹½åŒºåŸŸçš„å†…å®¹       |
| `fileListDisplay`    | `{ files: UploadFile[] }` | è‡ªå®šä¹‰æ–‡ä»¶åˆ—è¡¨å±•ç¤º   |
| `uploadButton`       | `-`                       | è‡ªå®šä¹‰ä¸Šä¼ æŒ‰é’®       |
| `cancelUploadButton` | `-`                       | è‡ªå®šä¹‰å–æ¶ˆä¸Šä¼ æŒ‰é’®   |

ğŸ”— [æŸ¥çœ‹ TDesign Upload å®Œæ•´ Slots](https://tdesign.tencent.com/vue-next/components/upload?tab=api)

### Methods

ç»„ä»¶æš´éœ²çš„æ–¹æ³•ï¼š

| åç§°                | å‚æ•°                                    | è¯´æ˜                                             |
| ------------------- | --------------------------------------- | ------------------------------------------------ |
| `triggerUpload`     | `-`                                     | æ‰‹åŠ¨è§¦å‘ä¸Šä¼                                      |
| `uploadFilePercent` | `{ file: UploadFile, percent: number }` | æ›´æ–°æ–‡ä»¶ä¸Šä¼ è¿›åº¦                                 |
| `uploadFiles`       | `files: UploadFile[]`                   | æ‰¹é‡ä¸Šä¼ æ–‡ä»¶                                     |
| `instance`          | `-`                                     | è·å– `TDesign Upload` ç»„ä»¶å®ä¾‹ï¼Œå¯è°ƒç”¨å…¶æ‰€æœ‰æ–¹æ³• |

ğŸ”— [æŸ¥çœ‹ TDesign Upload å®Œæ•´ Methods](https://tdesign.tencent.com/vue-next/components/upload?tab=api)

## ç±»å‹å®šä¹‰

```ts
import type { UploadFile, UploadInstanceFunctions, UploadProps, DialogProps } from '@seevin/ui'
import { Ref } from 'vue'

export interface ProUploadProps extends UploadProps {
  /**
   * @description æ–‡ä»¶ç­¾åå‡½æ•°ã€‚props ä¼˜å…ˆçº§æœ€é«˜ï¼Œå…¶æ¬¡æ˜¯ ProConfigProviderã€‚
   */
  signature?: (fileName: string, file: UploadFile) => Promise<ProUploadSignature>
  /**
   * @description æ–‡ä»¶é‡å‘½åå‡½æ•°ï¼Œè¿”å›æ–°çš„æ–‡ä»¶åã€‚
   */
  rename?: (file: UploadFile) => string
  /**
   * @description å›¾ç‰‡è£å‰ªæ¯”ä¾‹ï¼Œæ ¼å¼ä¸º "4:3" æˆ– "16:9"
   */
  aspectRatio?: string
  /**
   * @description vue-cropper çš„é…ç½®é¡¹
   */
  cropperProps?: Record<string, any>
  /**
   * @description t-dialog çš„é…ç½®é¡¹ï¼Œç”¨äºæ§åˆ¶è£å‰ªå¼¹çª—
   */
  dialogProps?: DialogProps
}

export interface ProUploadSignature {
  accessId: string
  dir: string
  fileName: string
  host: string
  policy: string
  signature: string
}

export interface ProUploadExpose extends UploadInstanceFunctions {
  /** @description è·å–ä¸Šä¼ å®ä¾‹ æœ‰äº›å®ä¾‹æ–¹æ³•æ²¡æœ‰åœ¨ UploadInstanceFunctions ä¸­å®šä¹‰ï¼Œéœ€è¦é€šè¿‡è¯¥å®ä¾‹è°ƒç”¨ */
  instance: Ref<UploadInstanceFunctions | undefined>
}
```

## æœ€ä½³å®è·µ

### 1. å®‰å…¨æ€§é…ç½®

```javascript
// åç«¯ç­¾åæ¥å£ç¤ºä¾‹
const getOSSSignature = async (fileName, file) => {
  try {
    const response = await fetch('/api/oss/signature', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${getAuthToken()}`
      },
      body: JSON.stringify({
        fileName,
        fileSize: file.size,
        fileType: file.type
      })
    })

    if (!response.ok) {
      throw new Error('è·å–ç­¾åå¤±è´¥')
    }

    return await response.json()
  } catch (error) {
    console.error('ç­¾åè·å–å¤±è´¥:', error)
    throw error
  }
}
```

### 2. æ–‡ä»¶ç±»å‹é™åˆ¶æœ€ä½³å®è·µ

```javascript
// æ¨èçš„æ–‡ä»¶ç±»å‹é…ç½®ï¼ˆMIME ç±»å‹ï¼‰
const acceptConfigs = {
  image: 'image/*', // æ‰€æœ‰å›¾ç‰‡ç±»å‹
  imageSpecific: 'image/jpeg,image/png,image/gif,image/webp', // ç‰¹å®šå›¾ç‰‡ç±»å‹
  document: 'application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document', // PDFå’ŒWord
  video: 'video/*', // æ‰€æœ‰è§†é¢‘ç±»å‹
  audio: 'audio/*', // æ‰€æœ‰éŸ³é¢‘ç±»å‹
  text: 'text/plain,text/csv' // æ–‡æœ¬æ–‡ä»¶
}

// ä½¿ç”¨ç¤ºä¾‹
<ProUpload accept={acceptConfigs.image} />
<ProUpload accept={acceptConfigs.document} />
```

**æ³¨æ„**ï¼šç»„ä»¶å†…éƒ¨ä½¿ç”¨ `mime-match` åº“è¿›è¡Œ MIME ç±»å‹åŒ¹é…ï¼Œç¡®ä¿äº†å‡†ç¡®çš„æ–‡ä»¶ç±»å‹éªŒè¯ã€‚

### 3. å…¨å±€é…ç½®ç¤ºä¾‹

```vue
<template>
  <ProConfigProvider :config="uploadConfig">
    <div id="app">
      <router-view />
    </div>
  </ProConfigProvider>
</template>

<script setup>
import { reactive } from 'vue'
import { MessagePlugin } from 'tdesign-vue-next'

const uploadConfig = reactive({
  proUpload: {
    // å…¨å±€ç­¾åå‡½æ•°
    signature: async (fileName, file) => {
      return await getOSSSignature(fileName, file)
    },

    // å…¨å±€æ–‡ä»¶é‡å‘½å
    rename: file => {
      const timestamp = Date.now()
      const randomStr = Math.random().toString(36).substring(2, 8)
      const ext = file.name.split('.').pop()
      return `${timestamp}_${randomStr}.${ext}`
    },

    // å…¨å±€ä¸Šä¼ å‰éªŒè¯
    beforeUpload: file => {
      // æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ100MBï¼‰
      const maxSize = 100 * 1024 * 1024
      if (file.size > maxSize) {
        MessagePlugin.error('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 100MB')
        return false
      }
      return true
    },

    // å…¨å±€é”™è¯¯å¤„ç†
    onFail: ({ file, error }) => {
      console.error(`æ–‡ä»¶ ${file.name} ä¸Šä¼ å¤±è´¥:`, error)
      MessagePlugin.error(`æ–‡ä»¶ ${file.name} ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•`)
    },

    // å…¨å±€è£å‰ªé…ç½®
    cropperProps: {
      outputType: 'jpeg',
      outputSize: 0.9,
      canScale: true
    },

    // å…¨å±€è£å‰ªå¼¹çª—é…ç½®
    dialogProps: {
      width: '800px',
      placement: 'center'
    }
  }
})
</script>
```

### 4. å¸¸ç”¨è£å‰ªæ¯”ä¾‹é…ç½®

```javascript
// å¸¸ç”¨çš„å›¾ç‰‡è£å‰ªæ¯”ä¾‹
const cropRatios = {
  square: '1:1', // æ­£æ–¹å½¢ï¼ˆå¤´åƒã€å›¾æ ‡ï¼‰
  landscape: '16:9', // æ¨ªå‘ï¼ˆæ¨ªå¹…ã€è§†é¢‘å°é¢ï¼‰
  portrait: '9:16', // ç«–å‘ï¼ˆæ‰‹æœºå£çº¸ã€æ•…äº‹ï¼‰
  photo: '4:3', // ç…§ç‰‡ï¼ˆä¼ ç»Ÿç›¸æœºæ¯”ä¾‹ï¼‰
  widescreen: '21:9', // è¶…å®½å±ï¼ˆç”µå½±ã€æ¨ªå¹…ï¼‰
  card: '3:2', // å¡ç‰‡ï¼ˆåç‰‡ã€è¯ä»¶ç…§ï¼‰
  a4: '210:297' // A4 çº¸å¼ æ¯”ä¾‹
}

// ä½¿ç”¨ç¤ºä¾‹
<ProUpload aspect-ratio="1:1" /> // å¤´åƒä¸Šä¼ 
<ProUpload aspect-ratio="16:9" /> // æ¨ªå¹…å›¾ç‰‡
<ProUpload aspect-ratio="4:3" /> // äº§å“å›¾ç‰‡
```

## ä½¿ç”¨æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§**ï¼šç­¾åå‡½æ•°å¿…é¡»åœ¨åç«¯å®ç°ï¼Œä¸è¦åœ¨å‰ç«¯ç¡¬ç¼–ç  AccessKey
2. **æ–‡ä»¶å¤§å°**ï¼šå»ºè®®åœ¨ `beforeUpload` ä¸­é™åˆ¶æ–‡ä»¶å¤§å°ï¼Œé¿å…ä¸Šä¼ è¿‡å¤§æ–‡ä»¶
3. **ç½‘ç»œçŠ¶æ€**ï¼šåœ¨ç½‘ç»œä¸ç¨³å®šçš„ç¯å¢ƒä¸‹å»ºè®®å®ç°é‡è¯•æœºåˆ¶
4. **å†…å­˜ä¼˜åŒ–**ï¼šå¯¹äºå¤§é‡æ–‡ä»¶ä¸Šä¼ ï¼Œæ³¨æ„åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„æ–‡ä»¶å¼•ç”¨
5. **å…¼å®¹æ€§**ï¼šåœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸­å¯èƒ½éœ€è¦ polyfill æ”¯æŒ
6. **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›æ¸…æ™°çš„ä¸Šä¼ çŠ¶æ€åé¦ˆå’Œé”™è¯¯æç¤º
7. **å›¾ç‰‡è£å‰ª**ï¼šè£å‰ªåŠŸèƒ½ä»…å¯¹å›¾ç‰‡æ–‡ä»¶ç”Ÿæ•ˆï¼Œéå›¾ç‰‡æ–‡ä»¶ä¼šè·³è¿‡è£å‰ªæµç¨‹ç›´æ¥ä¸Šä¼ 
8. **è£å‰ªæ¯”ä¾‹**ï¼š`aspectRatio` æ ¼å¼å¿…é¡»ä¸º `"å®½:é«˜"`ï¼Œå¦‚ `"16:9"`ã€`"4:3"`ã€`"1:1"` ç­‰

## ç›¸å…³ç»„ä»¶

- [`ProConfigProvider`](/components/config-provider) - å…¨å±€é…ç½®ç»„ä»¶ï¼Œç”¨äºé…ç½®ä¸Šä¼ ç»„ä»¶çš„å…¨å±€å‚æ•°
- [`ProForm`](/components/form) - è¡¨å•ç»„ä»¶ï¼Œå¸¸ä¸ä¸Šä¼ ç»„ä»¶ç»“åˆä½¿ç”¨
- [`ProTable`](/components/table) - è¡¨æ ¼ç»„ä»¶ï¼Œå¯åœ¨è¡¨æ ¼ä¸­æ˜¾ç¤ºä¸Šä¼ çš„æ–‡ä»¶
